---
import Layout from '../../../layouts/Layout.astro'
import BlogPost from '../../../components/BlogPost.astro'
import { getCollection } from 'astro:content'
import { getLangFromUrl, buildBlogPostPath } from '../../../i18n/utils';

const allPosts = await getCollection('blog', (entry) => entry.id.startsWith('de/'))
const pageTitle = "Blog";
const lang = getLangFromUrl(Astro.url);

const description = 'The blog index page'
---

<Layout pageTitle={pageTitle} description={description} >
  <h1>{pageTitle}</h1>
  <ul aria-label="Blog Posts">
    {allPosts.map((post) => (
      <BlogPost
        url={buildBlogPostPath(lang, post.id)}
        title={post.data.title}
      />
    ))}
  </ul>
</Layout>